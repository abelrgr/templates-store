<!-- Main Content -->
<main class="container mx-auto px-4 py-8" id="templates">
  <!-- Filters -->
  <div
    class="mb-12 flex justify-center"
    data-aos="fade-up"
    data-aos-delay="400"
  >
    <div
      class="flex gap-2 overflow-x-auto pb-4 p-2 w-full md:w-auto justify-start md:justify-center no-scrollbar"
    >
      <button
        @click="category = 'all'; filterTag = ''"
        :class="category === 'all' && !filterTag ? 'bg-indigo-600 text-white shadow-lg shadow-indigo-500/30' : 'bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-gray-50 dark:hover:bg-slate-700'"
        class="px-6 py-2.5 rounded-full font-medium transition-all duration-300 whitespace-nowrap cursor-pointer"
      >
        All
      </button>
      <template x-for="cat in getCategories()" :key="cat">
        <button
          @click="category = cat; filterTag = ''"
          :class="category === cat ? 'bg-indigo-600 text-white shadow-lg shadow-indigo-500/30' : 'bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-gray-50 dark:hover:bg-slate-700'"
          class="px-6 py-2.5 rounded-full font-medium capitalize transition-all duration-300 whitespace-nowrap cursor-pointer"
          x-text="cat"
        ></button>
      </template>
    </div>
  </div>

  <!-- Popular Tags -->
  <div
    class="mb-12 flex flex-wrap justify-center gap-2"
    data-aos="fade-up"
    data-aos-delay="450"
  >
    <span
      class="text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center mr-2"
    >
      Popular Tags:
    </span>
    <template x-for="tag in getTopTags(6)" :key="tag">
      <button
        @click="setFilterTag(tag)"
        :class="filterTag === tag ? 'bg-indigo-100 text-indigo-700 dark:bg-indigo-900/40 dark:text-indigo-300' : 'text-slate-500 dark:text-slate-400 hover:text-indigo-600 dark:hover:text-indigo-400'"
        class="text-xs font-medium px-2 py-1 rounded transition-colors cursor-pointer"
        x-text="'#' + tag"
      ></button>
    </template>
  </div>

  <!-- Active Tag Filter Indicator -->
  <div x-show="filterTag" x-transition class="mb-8 flex justify-center">
    <div
      class="flex items-center gap-2 px-4 py-2 bg-indigo-50 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300 rounded-full border border-indigo-200 dark:border-indigo-800"
    >
      <span class="text-xs font-bold uppercase tracking-wider">
        Filtered by:
      </span>
      <span class="font-semibold" x-text="filterTag"></span>
      <button
        @click="filterTag = ''"
        class="hover:text-indigo-900 dark:hover:text-indigo-100 transition-colors"
      >
        <svg
          class="w-4 h-4"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          />
        </svg>
      </button>
    </div>
  </div>

  <!-- Grid -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
    <div
      x-show="filteredTemplates.length === 0"
      class="col-span-full py-20 text-center"
      data-aos="fade-up"
    >
      <div
        class="inline-flex items-center justify-center w-24 h-24 rounded-full bg-slate-100 dark:bg-slate-800 text-slate-400 mb-6"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-12 w-12"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="1.5"
            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
          />
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="1"
            d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"
          />
        </svg>
      </div>
      <h3 class="text-2xl font-bold text-slate-800 dark:text-white mb-2">
        No templates found
      </h3>
      <p class="text-slate-600 dark:text-slate-400 mb-8 max-w-md mx-auto">
        We couldn't find any templates matching your search criteria. Please try
        different keywords or adjust your filters.
      </p>
      <button
        @click="search = ''; category = 'all'; filterTag = ''"
        class="inline-flex items-center px-6 py-3 rounded-xl bg-indigo-600 text-white font-semibold hover:bg-indigo-700 transition-colors shadow-lg shadow-indigo-500/25"
      >
        Clear all filters
      </button>
    </div>

    <template
      x-for="(template, index) in paginatedTemplates"
      :key="template.folder"
    >
      <div
        x-data="{ isVisible: false, isLoaded: false }"
        x-intersect.once="isVisible = true"
        class="bg-white dark:bg-slate-800 rounded-2xl shadow-lg shadow-slate-200/50 dark:shadow-none overflow-hidden hover:shadow-2xl hover:shadow-indigo-500/10 hover:-translate-y-1 transition-all duration-300 group border border-slate-100 dark:border-slate-700 flex flex-col h-full"
        :data-aos="'fade-up'"
        :data-aos-delay="index * 100"
      >
        <div
          class="relative overflow-hidden h-56 bg-slate-100 dark:bg-slate-700"
        >
          <!-- Loading Spinner -->
          <div
            x-show="!isLoaded"
            class="absolute inset-0 flex items-center justify-center bg-slate-100 dark:bg-slate-700"
          >
            <svg
              class="animate-spin h-8 w-8 text-indigo-500"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
            >
              <circle
                class="opacity-25"
                cx="12"
                cy="12"
                r="10"
                stroke="currentColor"
                stroke-width="4"
              ></circle>
              <path
                class="opacity-75"
                fill="currentColor"
                d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
              ></path>
            </svg>
          </div>

          <img
            :src="isVisible ? template.image : 'data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 1 1\'%3E%3C/svg%3E'"
            :alt="template.title"
            @load="isLoaded = true"
            loading="lazy"
            :class="isLoaded ? 'opacity-100 scale-100' : 'opacity-0 scale-105'"
            class="w-full h-full object-cover transform transition-all duration-700 group-hover:scale-110"
          />
          <div
            class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end justify-between p-4"
          >
            <button
              @click="openQuickview(template)"
              class="bg-white/90 backdrop-blur-sm text-slate-900 px-4 py-2 rounded-full text-sm font-semibold hover:bg-white transition-colors transform translate-y-4 group-hover:translate-y-0 duration-300"
            >
              Quick View
            </button>
          </div>

          <div class="absolute top-4 left-4 flex gap-2">
            <span
              class="px-3 py-1 bg-white/90 dark:bg-slate-900/90 backdrop-blur rounded-lg text-xs font-bold uppercase tracking-wider text-slate-700 dark:text-slate-300 shadow-sm"
              x-text="template.category"
            ></span>
            <span
              class="px-3 py-1 bg-indigo-600/90 backdrop-blur rounded-lg text-xs font-bold text-white shadow-sm"
              x-show="template.version"
              x-text="'v' + template.version"
            ></span>
          </div>

          <!-- Like Button -->
          <button
            @click.stop="toggleFavorite(template.folder)"
            class="absolute top-4 right-4 p-2.5 rounded-full bg-white/90 dark:bg-slate-900/90 backdrop-blur shadow-sm hover:scale-110 transition-transform"
            :class="isFavorite(template.folder) ? 'text-red-500' : 'text-slate-400 dark:text-slate-500'"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-5 w-5"
              :fill="isFavorite(template.folder) ? 'currentColor' : 'none'"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"
              />
            </svg>
          </button>
        </div>

        <div class="p-6 flex flex-col flex-1">
          <div class="flex justify-between items-start mb-3">
            <h2
              class="text-xl font-bold text-slate-800 dark:text-white group-hover:text-indigo-600 dark:group-hover:text-indigo-400 transition-colors"
              x-text="template.title"
            ></h2>
            <div
              class="flex items-center bg-yellow-50 dark:bg-yellow-900/20 px-2 py-1 rounded-md"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-4 w-4 text-yellow-500 fill-current"
                viewBox="0 0 20 20"
              >
                <path
                  d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"
                />
              </svg>
              <span
                class="ml-1 text-xs font-bold text-yellow-700 dark:text-yellow-500"
                x-text="template.rating"
              ></span>
            </div>
          </div>

          <p
            class="text-slate-600 dark:text-slate-400 text-sm mb-5 line-clamp-2 leading-relaxed"
            x-text="template.description"
          ></p>

          <div class="flex flex-wrap gap-2 mb-6">
            <template x-for="tag in template.tags" :key="tag">
              <button
                @click.stop="setFilterTag(tag)"
                class="px-2.5 py-1 text-[10px] uppercase font-bold tracking-wider bg-slate-100 dark:bg-slate-700/50 rounded-md text-slate-500 dark:text-slate-400 hover:bg-indigo-100 dark:hover:bg-indigo-900/30 hover:text-indigo-600 transition-colors cursor-pointer"
                x-text="tag"
              ></button>
            </template>
          </div>

          <div
            class="flex justify-between items-center mt-auto pt-4 border-t border-slate-100 dark:border-slate-700/50"
          >
            <div
              class="text-xs font-medium text-slate-400 dark:text-slate-500 flex items-center gap-3"
            >
              <div class="flex items-center gap-1" title="Views">
                <svg
                  class="w-4 h-4"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
                  />
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"
                  />
                </svg>
                <span x-text="template.stats.views"></span>
              </div>
              <div class="flex items-center gap-1" title="Downloads">
                <svg
                  class="w-4 h-4"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"
                  />
                </svg>
                <span x-text="template.stats.downloads"></span>
              </div>
            </div>
            <button
              @click="openModal(template)"
              class="text-indigo-600 dark:text-indigo-400 font-semibold text-sm hover:underline flex items-center group-hover:translate-x-1 transition-transform cursor-pointer"
            >
              Details
              <svg
                class="w-4 h-4 ml-1"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 5l7 7-7 7"
                />
              </svg>
            </button>
          </div>
        </div>
      </div>
    </template>

    <!-- Coming Soon Card -->
    <div
      x-data="{ isVisible: false, isVideoLoaded: false }"
      x-intersect.once="isVisible = true"
      x-show="!search && category === 'all' && !filterTag"
      class="relative bg-indigo-50 dark:bg-slate-900 rounded-2xl shadow-lg shadow-slate-200/50 dark:shadow-none overflow-hidden border-2 border-dashed border-indigo-300 dark:border-indigo-700 flex flex-col h-full items-center justify-center min-h-[32rem] group"
      data-aos="fade-up"
      :data-aos-delay="(paginatedTemplates.length) * 100"
    >
      <!-- Loading Spinner for Video -->
      <div
        x-show="isVisible && !isVideoLoaded"
        class="absolute inset-0 flex items-center justify-center z-10"
      >
        <svg
          class="animate-spin h-10 w-10 text-white"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
        >
          <circle
            class="opacity-25"
            cx="12"
            cy="12"
            r="10"
            stroke="currentColor"
            stroke-width="4"
          ></circle>
          <path
            class="opacity-75"
            fill="currentColor"
            d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
          ></path>
        </svg>
      </div>

      <template x-if="isVisible">
        <video
          autoplay
          muted
          loop
          playsinline
          @loadeddata="isVideoLoaded = true"
          :class="isVideoLoaded ? 'opacity-60 dark:opacity-40' : 'opacity-0'"
          class="absolute inset-0 w-full h-full object-cover transition-opacity duration-700 group-hover:scale-110"
        >
          <source src="assets/more-templates-coming.mp4" type="video/mp4" />
        </video>
      </template>

      <!-- Gradient Overlay -->
      <div class="absolute inset-0 bg-slate-900/50 backdrop-blur-[1px]"></div>

      <div class="text-center relative z-10 p-6">
        <h3 class="text-2xl font-bold text-white mb-2 shadow-sm">
          More Templates Coming
        </h3>
        <p class="text-indigo-50/90 mb-6 text-sm leading-relaxed font-medium">
          Exciting new templates are coming on
          <span x-text="formattedTargetDate" class="font-bold"></span>.
          <br />
          Stay tuned!
        </p>
        <div
          class="bg-white/10 dark:bg-slate-800/40 rounded-xl p-4 backdrop-blur-md border border-white/20 dark:border-indigo-500/30"
        >
          <p
            class="text-xs uppercase tracking-widest text-indigo-200 font-bold mb-2"
          >
            Countdown to <span x-text="formattedTargetDate"></span>
          </p>
          <div class="flex justify-around items-center gap-2">
            <div class="flex flex-col items-center">
              <div
                class="bg-indigo-600/90 dark:bg-indigo-500/90 text-white rounded-lg px-3 py-2 font-bold text-lg w-12 text-center shadow-lg"
                x-text="String(countdownDays).padStart(2, '0')"
              ></div>
              <span class="text-xs text-indigo-100 mt-1 font-medium">
                Days
              </span>
            </div>
            <span class="text-white font-bold">:</span>
            <div class="flex flex-col items-center">
              <div
                class="bg-indigo-600/90 dark:bg-indigo-500/90 text-white rounded-lg px-3 py-2 font-bold text-lg w-12 text-center shadow-lg"
                x-text="String(countdownHours).padStart(2, '0')"
              ></div>
              <span class="text-xs text-indigo-100 mt-1 font-medium">
                Hours
              </span>
            </div>
            <span class="text-white font-bold">:</span>
            <div class="flex flex-col items-center">
              <div
                class="bg-indigo-600/90 dark:bg-indigo-500/90 text-white rounded-lg px-3 py-2 font-bold text-lg w-12 text-center shadow-lg"
                x-text="String(countdownMinutes).padStart(2, '0')"
              ></div>
              <span class="text-xs text-indigo-100 mt-1 font-medium">
                Min
              </span>
            </div>
            <span class="text-white font-bold">:</span>
            <div class="flex flex-col items-center">
              <div
                class="bg-indigo-600/90 dark:bg-indigo-500/90 text-white rounded-lg px-3 py-2 font-bold text-lg w-12 text-center shadow-lg"
                x-text="String(countdownSeconds).padStart(2, '0')"
              ></div>
              <span class="text-xs text-indigo-100 mt-1 font-medium">
                Sec
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Pagination -->
  <div
    class="mt-12 flex justify-center items-center space-x-4"
    x-show="totalPages > 1"
  >
    <button
      @click="currentPage--"
      :disabled="currentPage === 1"
      class="p-2 rounded-lg bg-white dark:bg-gray-800 shadow disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100 dark:hover:bg-gray-700 transition"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-6 w-6"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M15 19l-7-7 7-7"
        />
      </svg>
    </button>
    <div class="text-sm font-medium">
      Page <span x-text="currentPage"></span> of
      <span x-text="totalPages"></span>
    </div>
    <button
      @click="currentPage++"
      :disabled="currentPage === totalPages"
      class="p-2 rounded-lg bg-white dark:bg-gray-800 shadow disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100 dark:hover:bg-gray-700 transition"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-6 w-6"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M9 5l7 7-7 7"
        />
      </svg>
    </button>
  </div>
</main>

<include href="partials/modals/details.html" />

<include href="partials/modals/quickview.html" />

<include href="partials/modals/error.html" />
